<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Troubleshooting Guide: Troubleshooting Deafness</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen_manual.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Troubleshooting Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('troubleshootingdeafness.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Troubleshooting Deafness </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The most common problem is that a subscriber for a UM topic is deafness - not receiving messages from one or more publishers of that topic.</p>
<p><br />
 </p>
<h1><a class="anchor" id="applicationlogsboseos"></a>
Application Logs BOS / EOS&nbsp;&nbsp;<small><a href="#applicationlogsboseos">&lt;-</a></small></h1>
<p>If your application logs BOS and EOS events, follow these steps. (If not, go to <a class="el" href="troubleshootingdeafness.html#trylbmrcv">Try Lbmrcv</a>.)</p>
<p>Troubleshooting steps: </p><ol>
<li>
Identify the UM topic name. (Requires knowledge of the application.) </li>
<li>
Log into the subscriber host. </li>
<li>
Examine the subscriber's <a class="el" href="troubleshootingprerequisites.html#applicationlogfiles">log file</a>. Look for BOS and EOS events for the topic in question. The <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/umobjects.html#sourcestring">Source String</a> will identify the IP of the publisher. <ul>
<li>
Have multiple EOS events: Go to <a class="el" href="troubleshootingdeafness.html#rollingeos">Rolling EOS</a>. </li>
<li>
Have no BOS or EOS: Go to <a class="el" href="troubleshootingdeafness.html#checkmulticasttr">Check Multicast TR</a>. </li>
<li>
Have BOS but no EOS. Go to next step. </li>
</ul>
</li>
<li>
Check the IP address in the BOS <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/umobjects.html#sourcestring">Source String</a>. Verify that it is that of the desired publisher. <ul>
<li>
If not, then treat this as "no BOS or EOS" and go to <a class="el" href="troubleshootingdeafness.html#checkmulticasttr">Check Multicast TR</a>. </li>
<li>
If the BOS <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/umobjects.html#sourcestring">Source String</a> IP address is correct, this suggests that the connection is valid and that the publisher is not sending messages. Check application logic. </li>
</ul>
</li>
</ol>
<p><br />
 </p>
<h1><a class="anchor" id="trylbmrcv"></a>
Try Lbmrcv&nbsp;&nbsp;<small><a href="#trylbmrcv">&lt;-</a></small></h1>
<p>Troubleshooting steps: </p><ol>
<li>
Identify the UM topic name. (Requires knowledge of the application.) </li>
<li>
Log into the subscriber host. </li>
<li>
Determine the configuration in use by the subscriber. </li>
<li>
<p class="startli">Create a stand-alone configuration file consumable by "lbmrcv". This can be XML or flat file.</p>
<p>If using an XML file and you need an application name to match to, set the following environment variables: </p><ul>
<li>
LBM_XML_CONFIG_APPNAME=app_name </li>
<li>
BM_XML_CONFIG_FILENAME=file_name </li>
</ul>
<p class="endli">If using a flat file configuration file, set the following environment variable: </p><ul>
<li>
LBM_DEFAULT_CONFIG_FILE=file_name </li>
</ul>
<p>These should be set prior to the next step. </p>
</li>
<li>
Run the "lbmrcv" command (see <a class="el" href="troubleshootingprerequisites.html#troubleshootingtools">Troubleshooting Tools</a>): <pre>
lbmrcv -v -v topic_name
</pre> where "topic_name" is the topic experiencing deafness. </li>
<li>
Watch lbmrcv's output for BOS / EOS events. It may take several seconds. The <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/umobjects.html#sourcestring">Source String</a> will identify the IP of the publisher. <ul>
<li>
Have multiple EOS events: Go to <a class="el" href="troubleshootingdeafness.html#rollingeos">Rolling EOS</a>. </li>
<li>
Have no BOS or EOS: Go to <a class="el" href="troubleshootingdeafness.html#checkmulticasttr">Check Multicast TR</a>. </li>
<li>
Have BOS but no EOS. Go to next step. </li>
</ul>
</li>
<li>
Check the IP address in the BOS <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/umobjects.html#sourcestring">Source String</a>. Verify that it is that of the desired publisher. <ul>
<li>
If not, then treat this as "no BOS or EOS" and go to <a class="el" href="troubleshootingdeafness.html#checkmulticasttr">Check Multicast TR</a>. </li>
<li>
If the BOS <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/umobjects.html#sourcestring">Source String</a> IP address is correct, this suggests that the connection is valid and that the publisher is not sending messages. Check application logic. </li>
</ul>
</li>
</ol>
<dl class="section attention"><dt>Attention</dt><dd>Performing this test can sometimes "fix" the deafness of the subscriber application. If that is the case, then the problem is related to Topic Resolution going <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/topicresolutiondescription.html#quiescentphase">Quiescent</a>. For example, there may have been a network outage that lasted longer than the Topic Resolution sustaining periods. The <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/topicresolutiondescription.html#sustainingphase">Sustaining Phase</a> should be extended using <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/config.tag:../Config/" href="../Config/grpudpbasedresolveroperation.html#resolveradvertisementminimumsustaindurationsource">resolver_advertisement_minimum_sustain_duration (source)</a> and/or <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/config.tag:../Config/" href="../Config/grpudpbasedresolveroperation.html#resolverqueryminimumsustaindurationreceiver">resolver_query_minimum_sustain_duration (receiver)</a>.</dd></dl>
<p><br />
 </p>
<h1><a class="anchor" id="rollingeos"></a>
Rolling EOS&nbsp;&nbsp;<small><a href="#rollingeos">&lt;-</a></small></h1>
<p>A UM receiver can be in a state where it repeatedly reports EOS events (End Of Session) for a topic without corresponding BOS events (Beginning Of Session). These events are delivered to the application via the receiver callback and should be logged (see <a class="el" href="troubleshootingprerequisites.html#applicationlogfiles">Application Log Files</a>). See <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/fundamentalconcepts.html#receiverbosandeosevents">Receiver BOS and EOS Events</a> for deeper technical information on BOS/EOS.</p>
<p>The EOS events should occur every 60 seconds by default, but check your value for the configuration option <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/config.tag:../Config/" href="../Config/grptransportlbtrmoperation.html#transportlbtrmactivitytimeoutreceiver">transport_lbtrm_activity_timeout (receiver)</a>.</p>
<p>This state indicates that the subscriber is able to get Topic Resolution packets from the publisher, but the data transport packets can't get through.</p>
<p>Troubleshooting steps: </p><ol>
<li>
Examine the EOS message to determine the multicast group and port for the data transport. This comes from the <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/design.tag:../Design/" href="../Design/umobjects.html#sourcestring">Source String</a>. For example: <pre>
LBTRM:10.29.3.88:14390:e0679abb:231.13.13.13:14400[1539853954]
</pre> <ul>
<li>
10.29.3.88 - The IP address of the publisher host. </li>
<li>
231.13.13.13 - The transport group. </li>
<li>
14400 - The transport port. </li>
</ul>
</li>
<li>
Go to <a class="el" href="troubleshootingdeafness.html#verifymulticastconnectivity">Verify Multicast Connectivity</a> with <b>app_group</b> defined as the transport group and <b>app_port</b> defined as the transport port. </li>
</ol>
<p><br />
 </p>
<h1><a class="anchor" id="checkmulticasttr"></a>
Check Multicast TR&nbsp;&nbsp;<small><a href="#checkmulticasttr">&lt;-</a></small></h1>
<p>Troubleshooting steps: </p><ol>
<li>
Log into the subscriber and publisher hosts. </li>
<li>
Verify that the subscriber and publisher are configured for the same <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/config.tag:../Config/" href="../Config/grpmulticastresolvernetwork.html#resolvermulticastaddresscontext">Topic Resolution group address</a>. </li>
<li>
<p class="startli">On the publisher's host, list the multicast groups that the host is joined to. Verify that the configured <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/config.tag:../Config/" href="../Config/grpmulticastresolvernetwork.html#resolvermulticastaddresscontext">Topic Resolution group address</a> is listed and has a reference count of at least 1. If not, restart the publisher.</p>
<p>On Windows the command is: </p><pre>
netsh interface ipv4 show joins
</pre><p class="endli">On Unix the command is: </p><pre>
netstat -gn | egrep -v ":"
</pre> </li>
<li>
Do the same for the subscriber. </li>
<li>
Verify multicast connectivity for the Topic Resolution group address. Go to <a class="el" href="troubleshootingdeafness.html#verifymulticastconnectivity">Verify Multicast Connectivity</a> with <b>app_group</b> defined as the configured value for <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/config.tag:../Config/" href="../Config/grpmulticastresolvernetwork.html#resolvermulticastaddresscontext">resolver_multicast_address (context)</a> and <b>app_port</b> defined as the configured value for <a class="elRef" doxygen="/29W/Amun/home/sford/backup_exclude/labbox/sfordmac_DEV_MAIN/29West/lbm/doc/Tshoot/config.tag:../Config/" href="../Config/grpmulticastresolvernetwork.html#resolvermulticastportcontext">resolver_multicast_port (context)</a>. </li>
<li>
If mtools verifies that the TR multicast works, <a class="el" href="troubleshootingdeafness.html#trylbmrcv">Try Lbmrcv</a>. </li>
</ol>
<p><br />
 </p>
<h1><a class="anchor" id="verifymulticastconnectivity"></a>
Verify Multicast Connectivity&nbsp;&nbsp;<small><a href="#verifymulticastconnectivity">&lt;-</a></small></h1>
<p>This checks multicast connectivity between two hosts: A and B. You should already know which multicast group and port you are checking: <b>app_group</b> and <b>app_port</b>.</p>
<p>This sequence uses "mtools" commands "msend" and "mdump". See <a class="el" href="troubleshootingprerequisites.html#troubleshootingtools">Troubleshooting Tools</a>.</p>
<p>Troubleshooting steps: </p><ol>
<li>
Choose a port that is not the application port: <b>alt_port</b>. </li>
<li>
On host A open two command tool windows. </li>
<li>
In command tool A1, run: <pre>
msend app_group alt_port
</pre> </li>
<li>
In command tool A2, run: <pre>
mdump app_group alt_port
</pre> </li>
<li>
<b>Result</b>: the "mdump" command should display the messages sent. <br />
<b>Note</b>: leave both commands running for now. </li>
<li>
On host B open two command tool windows. </li>
<li>
In command tool B1, run: <pre>
msend app_group alt_port
</pre> </li>
<li>
In command tool B2, run: <pre>
mdump app_group alt_port
</pre> </li>
<li>
<b>Result</b>: the "mdump" commands on both hosts should display the messages sent by both hosts. </li>
</ol>
<p>If the "mtools" commands can't communicate, then there is a serious problem with either the host OS or the network. (Diagnosing host and network problems is beyond the scope of this guide.)</p>
<p><br />
 NEXT SECTION: <a class="el" href="troubleshootingloss.html">Troubleshooting Loss</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
</body>
</html>
